(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-371f59aa"],{3846:function(t,e,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"6b54":function(t,e,a){"use strict";a("3846");var n=a("cb7c"),s=a("0bfb"),o=a("9e1e"),i="toString",r=/./[i],l=function(t){a("2aba")(RegExp.prototype,i,t,!0)};a("79e5")((function(){return"/a/b"!=r.call({source:"a",flags:"b"})}))?l((function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?s.call(t):void 0)})):r.name!=i&&l((function(){return r.call(this)}))},b199:function(t,e,a){"use strict";a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return o})),a.d(e,"d",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"e",(function(){return l}));var n=a("66df"),s=function(t){return n["a"].request({url:"task",method:"get",params:t})},o=function(t){return n["a"].request({url:"task/"+t,method:"get"})},i=function(t){return n["a"].request({url:"task",method:"put",data:t})},r=function(t){var e="task/"+t;return n["a"].request({url:e,method:"delete"})},l=function(t){return n["a"].request({url:"task/run",method:"get",params:{tid:t.tid}})}},c444:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("i-form",{attrs:{model:t.page,inline:"","label-width":80}},[a("form-item",{attrs:{label:"名字"}},[a("i-input",{attrs:{type:"text",placeholder:"名字"},model:{value:t.page.name,callback:function(e){t.$set(t.page,"name",e)},expression:"page.name"}})],1),a("form-item",{attrs:{label:"命令"}},[a("i-input",{attrs:{type:"text",placeholder:"命令"},model:{value:t.page.command,callback:function(e){t.$set(t.page,"command",e)},expression:"page.command"}})],1),a("form-item",{attrs:{label:"容器ID"}},[a("InputNumber",{attrs:{min:0},model:{value:t.page.cid,callback:function(e){t.$set(t.page,"cid",e)},expression:"page.cid"}})],1),a("form-item",{attrs:{label:"当前状态"}},[a("i-select",{staticStyle:{width:"200px"},model:{value:t.page.status,callback:function(e){t.$set(t.page,"status",e)},expression:"page.status"}},[a("Option",{attrs:{value:"0"}},[t._v("全部")]),a("Option",{attrs:{value:"1"}},[t._v("等待")]),a("Option",{attrs:{value:"2"}},[t._v("开始")]),a("Option",{attrs:{value:"3"}},[t._v("成功")]),a("Option",{attrs:{value:"4"}},[t._v("失败")])],1)],1),a("i-button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.loadPage}},[t._v("查询")]),t._v("   \n            "),a("i-button",{attrs:{type:"success",icon:"ios-add-circle"},on:{click:t.windowAddTask},model:{value:t.showPut,callback:function(e){t.showPut=e},expression:"showPut"}},[t._v("新增")])],1)],1),a("div",[a("Table",{attrs:{border:"",columns:t.columns,data:t.tasks},scopedSlots:t._u([{key:"disable",fn:function(e){var n=e.row;return[a("i-switch",{attrs:{size:"large"},on:{"on-change":function(e){return t.switchTaskStatus(n)}},model:{value:n.disable,callback:function(e){t.$set(n,"disable",e)},expression:"row.disable"}})]}},{key:"log_enable",fn:function(e){var n=e.row;return[a("i-switch",{attrs:{size:"large"},on:{"on-change":function(e){return t.switchTaskStatus(n)}},model:{value:n.log_enable,callback:function(e){t.$set(n,"log_enable",e)},expression:"row.log_enable"}})]}},{key:"action",fn:function(e){var n=e.row;return[a("Button",{attrs:{type:"info",size:"small"},on:{click:function(e){return t.viewLog(n)}}},[t._v("日志")]),a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.rowPutTask(n)}}},[t._v("编辑")]),a("Button",{attrs:{type:"error",size:"small"},on:{click:function(e){return t.confirmRemove(n)}}},[t._v("删除")]),a("Button",{attrs:{type:"info",size:"small"},on:{click:function(e){return t.runTask(n)}}},[t._v("运行")])]}}])}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.page.total,"page-size":t.page.count,"show-sizer":""},on:{"on-change":t.changePageIndex,"on-page-size-change":t.changePageSize}})],1)])],1),a("div",[a("Modal",{attrs:{title:"操作任务"},on:{"on-ok":t.putTask},model:{value:t.showPut,callback:function(e){t.showPut=e},expression:"showPut"}},[a("div",[a("i-form",{ref:"form",attrs:{model:t.task,"label-width":80}},[a("FormItem",{attrs:{label:"任务ID"}},[a("i-input",{attrs:{disabled:""},model:{value:t.task.tid,callback:function(e){t.$set(t.task,"tid",e)},expression:"task.tid"}})],1),a("FormItem",{attrs:{label:"任务名"}},[a("i-input",{model:{value:t.task.name,callback:function(e){t.$set(t.task,"name",e)},expression:"task.name"}})],1),a("FormItem",{attrs:{label:"bash命令"}},[a("i-input",{attrs:{type:"textarea",clearable:""},model:{value:t.task.command,callback:function(e){t.$set(t.task,"command",e)},expression:"task.command"}})],1),a("FormItem",{attrs:{label:"超时时间"}},[a("i-input",{model:{value:t.task.timeout,callback:function(e){t.$set(t.task,"timeout",e)},expression:"task.timeout"}})],1),a("FormItem",{attrs:{label:"启用日志"}},[a("i-switch",{model:{value:t.task.log_enable,callback:function(e){t.$set(t.task,"log_enable",e)},expression:"task.log_enable"}})],1),a("FormItem",{attrs:{label:"禁用任务"}},[a("i-switch",{model:{value:t.task.disable,callback:function(e){t.$set(t.task,"disable",e)},expression:"task.disable"}})],1),a("FormItem",{attrs:{label:"活动目录"}},[a("i-input",{model:{value:t.task.directory,callback:function(e){t.$set(t.task,"directory",e)},expression:"task.directory"}})],1)],1)],1)])],1)])},s=[],o=(a("6b54"),a("b199")),i=a("c276"),r={name:"TaskList",mounted:function(){this.loadPage()},data:function(){var t=this;return{tasks:[],showPut:!1,page:{order:"tid",name:"",command:"",cid:0,status:0,total:0,index:1,count:20},task:{tid:0,name:"",command:"",timeout:0,log_enable:!1,disable:!1,directory:""},statusBtn:{1:{props:{type:"info",size:"small",icon:"md-arrow-down"},text:"等待"},2:{props:{type:"primary",size:"small",loading:!0},text:"进行"},3:{props:{type:"success",size:"small",icon:"md-checkmark"},text:"成功"},4:{props:{size:"small",type:"error",icon:"md-close"},text:"失败"}},search:"",columns:[{title:"状态",key:"status",width:"120",render:function(e,a){var n=a.row.status,s=t.statusBtn[n.toString()];return e("Button",{props:s.props},s.text)}},{title:"任务名",key:"name",tooltip:!0,width:"200"},{title:"容器ID",key:"cid",width:"80"},{title:"禁用任务",key:"disable",slot:"disable",width:"100"},{title:"bash命令",key:"command",resizable:!0,tooltip:!0},{title:"启用日志",slot:"log_enable",key:"log_enable",width:"100"},{title:"操作时间",key:"update_at",width:"150",render:function(t,e){var a=e.row.update_at,n=Object(i["c"])(a);return t("Span",{},n)}},{title:"操作",key:"action",align:"center",slot:"action",width:"240"}]}},methods:{loadPage:function(){var t=this;Object(o["c"])(this.page).then((function(e){t.tasks=e.items,t.page.total=e.page.total}))},putTask:function(){var t=this;Object(o["d"])(this.task).then((function(){t.$Message.success("操作成功~"),t.loadPage()}))},rowPutTask:function(t){this.task=t,this.showPut=!0},windowAddTask:function(){this.task={tid:0,name:"",expression:"",command:"",timeout:0,log_enable:!1,disable:!1,directory:""},this.showPut=!0},changePageIndex:function(t){this.page.index=t,this.loadPage()},changePageSize:function(t){this.page.index=1,this.page.count=t,this.loadPage()},runTask:function(t){var e=this;this.$Message.info("开启任务"),Object(o["e"])(t).then((function(){e.$Message.info("运行成功")})),this.loadPage()},confirmRemove:function(t){var e=this;this.$Modal.confirm({title:"确认",content:"<p>是否删除当前任务</p>",onOk:function(){e.remove(t)}})},remove:function(t){var e=this;Object(o["a"])(t.tid).then((function(){e.$Message.success("删除成功~"),e.loadPage()}))},switchTaskStatus:function(t){var e=this;Object(o["d"])(t).then((function(){e.$Message.success("操作成功~"),e.loadPage()}))},viewLog:function(t){this.$router.push({name:"log-list",params:{tid:t.tid}})}}},l=r,c=a("2877"),u=Object(c["a"])(l,n,s,!1,null,null,null);e["default"]=u.exports}}]);